from bs4 import BeautifulSoup


with open("../materials/evilcorp.html", 'r') as file:
    html_content = file.read()
soup = BeautifulSoup(html_content, "html.parser")
soup.title.string = "Evil Corp - Stealing your money every day"

username = soup.find("span", class_="name").get_text()
new_h1_tag = soup.new_tag("h1")
new_h1_tag.string = f"{username}, you are hacked!"
soup.body.insert(2, new_h1_tag)

new_script_tag = soup.new_tag("script")
new_script_tag.string = """
    hacked = function() {
        alert('hacked');
    }
    window.addEventListener('load', 
      function() { 
        var f = document.querySelector("form");
        f.setAttribute("onsubmit", "hacked()");
      },
      false
    );
"""
soup.body.insert(3, new_script_tag)

link = soup.find("a")
link["href"] = "https://mrrobot.fandom.com/wiki/Fsociety"
link.string = "Fsociety"

with open("../materials/evilcorp_hacked.html", 'w') as file:
    file.write(str(soup))
